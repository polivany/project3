import java.io.FileReader;
import java.util.Scanner;
import java.util.Random;

public class Master {
	
	public static void main(String[] args) throws java.io.IOException {

			FileReader fr = new FileReader("map.txt");// generates new filereader in order to get the map displayed when
														// initialized
			Scanner fileScanner = new Scanner(fr);
			EZImage[] walls = new EZImage[448];// creates an array for the amount of walls created
			int width = fileScanner.nextInt();
			int height = fileScanner.nextInt();
			String inputText;

			int count = 0;// allows a separate counter for amount of walls placed in order to keep the for
							// loop from adding to the same array slots

			EZ.initialize(1600, height * 10 - 10);
			EZImage background = EZ.addImage("pqbg.png", EZ.getWindowWidth() / 2, EZ.getWindowHeight() / 2);
			background.pushToBack();
			for (int row = 0; row < height; row++) {//Builds my map by scanning through each character in my text file.

				inputText = fileScanner.next();

				for (int column = 0; column < width; column++) {

					char wall = inputText.charAt(column);

					if (wall == '#') {
						walls[count] = EZ.addImage("wall.png", column * 10, row * 10);
						count++;
					}

				}
				
			}
			EZ.refreshScreen();
			fileScanner.close();
			
			Random randomX = new Random();//initialize random variables for later use on speed, destinations, etc.
			Random randomY = new Random();
			
			int pBarX = 1352;
			int pBarY = 333;
			
			int rBarX = 1438;
			int rBarY = 333;
			
			int gBarX = 1522;
			int gBarY = 333;
			
			int potNum = 0;
			
			int pSpawnTimer = 30;
			EZImage[] bars = new EZImage[15];
			
			Sorcerer sorc = new Sorcerer("sorcerer.png", 50, 50, 40, 60, 5, walls, 448);
			Potion pPot = new Potion("purplePotion.png", 360, 360, 400, 400, walls, 448);
			Potion rPot = new Potion("redPotion.png", 700, 360, 400, 400, walls, 448);
			Potion gPot = new Potion("greenPotion.png", 640, 700, 400, 400, walls, 448);
			
			
			while(true) {
			
			sorc.go();
			pPot.go();
			rPot.go();
			gPot.go();
			
			if(pPot.isInside(sorc.x, sorc.y) ) {
					pPot.collect();
					bars[potNum] = EZ.addImage("bar.png", pBarX, pBarY);
					pBarY -= 30;
					potNum++;
				}
			if(pPot.caught) {
			pPot.respawn();
			}
			
			
			if(rPot.isInside(sorc.x, sorc.y) ) {
				rPot.collect();
				bars[potNum] = EZ.addImage("bar.png", rBarX, rBarY);
				rBarY -= 30;
				potNum++;
			}
			if(rPot.caught) {
				rPot.respawn();
			}
		
			
			if(gPot.isInside(sorc.x, sorc.y) ) {
				gPot.collect();
				bars[potNum] = EZ.addImage("bar.png", gBarX, gBarY);
				gBarY -= 30;
				potNum++;
			}
			if(gPot.caught) {
				gPot.respawn();
			}
			
		EZ.refreshScreen();}
			
	}
}

